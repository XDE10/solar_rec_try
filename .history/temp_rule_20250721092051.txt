---
globs: *.ipynb
---
# Jupyter笔记本规范

## 笔记本组织
- 每个笔记本应有明确的单一用途
- 使用Markdown单元格为每个部分添加标题和说明
- 按照逻辑顺序组织单元格：导入、配置、数据加载、数据预处理、模型定义、训练、评估、可视化

## 代码质量
- 保持代码单元格简洁，避免过长函数
- 频繁使用的函数应考虑移至Python模块中
- 使用相对导入从项目模块导入代码
- 避免在笔记本中编写大型类或复杂算法

## 数据与模型
- 数据路径应使用相对路径，避免硬编码绝对路径
- 使用`%matplotlib inline`确保图表在笔记本中显示
- 对于大型数据集，考虑使用数据采样进行实验
- 模型检查点应保存在`models/`目录中

## 结果复现性
- 设置随机种子以确保结果可复现
- 记录实验参数和配置
- 保存关键图表和结果
- 记录环境依赖（可使用`!pip freeze`命令） 

---
description: 模型使用和实现指南
---
# 模型使用和实现指南

## 分割模型
- 使用`segmentation_models_pytorch`库作为语义分割的基础
- 支持的骨干网络包括：ResNet, EfficientNet, MobileNet等
- 支持的分割架构包括：UNet, FPN, DeepLabV3+, PSPNet等
- 主要实现在`src/models/segmentation/`目录中
- 数据加载和预处理在`dataloader.py`和`datasets.py`中定义
- 训练流程在`train.py`中，推理流程在`inference.py`中

## 目标检测模型
- 使用YOLOv5进行目标检测
- 所有YOLOv5相关代码在`src/models/yolo/yolov5/`目录中
- 训练配置文件在`src/models/yolo/sp_dataset.yaml`中
- 使用`train.py`进行训练，`detect.py`进行推理
- 图像标注应遵循YOLO格式

## 模型训练最佳实践
- 在训练前设置随机种子确保可重复性
- 使用适当的学习率调度器（如CosineAnnealingLR）
- 实现早停以避免过拟合
- 定期保存检查点，特别是在性能提升时
- 使用混合精度训练加速训练过程
- 在训练期间监控验证集性能

## 模型评估
- 对于分割任务，使用IoU, Dice系数等指标
- 对于检测任务，使用mAP, Precision, Recall等指标
- 使用混淆矩阵进行错误分析
- 在测试集上进行最终评估，不要在此数据上调整超参数 